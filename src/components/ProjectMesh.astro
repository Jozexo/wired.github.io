---
import { projects } from "../data/projects";
import ProjectNode from "./ProjectNode.astro";
import "../styles/components/project-mesh.css";
---
<section id="projects" class="section">
  <div class="mb-4">
    <h2 class="text-lg md:text-xl lg:text-2xl font-bold text-(--muted)">
      <span class="hero-name glitch glitch-anim text-(--accent-pink)" data-text="#proyectos">#proyectos</span>
    </h2>
  </div>

  <div class="mesh mesh--grid2">
    {projects.map(p => (<ProjectNode project={p} />))}
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const cards = document.querySelectorAll('.project-card--image-focus');
      if (!('IntersectionObserver' in window)) {
        cards.forEach((c) => c.classList.add('is-visible'));
        return;
      }
      const observer = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            obs.unobserve(entry.target);
          }
        });
      }, { threshold: 0.2 });
      cards.forEach(card => observer.observe(card));
    });
  </script>
</section>
