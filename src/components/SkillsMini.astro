---
import SkillIcon from "./icons/SkillIcon.astro";
import "../styles/components/skills.css";

interface Group { key: string; label: string; items: string[] }
const groups: Group[] = [
  { key: "security", label: "ciberseguridad", items: ["pentesting", "vuln-analysis", "hardening", "bash"] },
  { key: "dev", label: "lenguajes y frameworks", items: ["python", "javascript", "php", "c#", "flask", "laravel"] },
  { key: "data", label: "datos", items: ["postgresql", "sql server"] },
  { key: "net", label: "redes", items: ["mikrotik", "routing", "firewall", "vpn"] },
];
---
<section id="skills" class="section pt-0">
  <h2 class="text-lg md:text-xl lg:text-2xl font-bold text-(--muted) mb-3">
    <span class="hero-name glitch glitch-anim text-(--accent-pink)" data-text="#habilidades">#habilidades</span>
  </h2>

  <div class="mesh">
    {groups.map(g => (
      <div class="node reveal" role="listitem" data-group={g.key} data-skillbox>
        <div class="flex items-center justify-between gap-2 mb-2">
          <h3 class="font-semibold text-(--fg)">{g.label}</h3>
        </div>
        <p class="text-sm text-(--muted) mb-3">{/* descripci√≥n opcional */}</p>
        <div class="flex flex-wrap gap-2">
          {g.items.map(item => (
            <span class="skill-chip text-xs px-2 py-1 rounded border border-(--grid)/80 text-(--muted) inline-flex items-center gap-2">
              <SkillIcon name={item} size={14} />
              <span class="capitalize">{item}</span>
            </span>
          ))}
        </div>
      </div>
    ))}
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const section = document.getElementById('skills');
      if (!section) return;
      const items = section.querySelectorAll('.reveal');
      if (!('IntersectionObserver' in window)) {
        items.forEach(el => el.classList.add('is-visible'));
        return;
      }
      const io = new IntersectionObserver((entries, obs) => {
        entries.forEach(e => {
          if (e.isIntersecting) {
            e.target.classList.add('is-visible');
            obs.unobserve(e.target);
          }
        });
      }, { threshold: 0.15 });
      items.forEach(el => io.observe(el));
    });
  </script>

</section>
